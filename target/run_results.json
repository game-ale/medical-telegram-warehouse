{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b4", "generated_at": "2026-01-20T16:27:53.815303Z", "invocation_id": "36023f5c-f55f-4461-a709-0bae7869b407", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.165322Z", "completed_at": "2026-01-20T16:27:53.171485Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.171485Z", "completed_at": "2026-01-20T16:27:53.264963Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10430741310119629, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.stg_yolo_detections", "compiled": true, "compiled_code": "with raw_detections as (\n    select * from \"medical_warehouse\".\"raw\".\"yolo_detections\"\n),\n\nflattened as (\n    select\n        message_id,\n        channel_name,\n        jsonb_array_elements(detection_data) as detection\n    from raw_detections\n)\n\nselect\n    message_id,\n    channel_name,\n    detection->>'class' as class_name,\n    cast(detection->>'confidence' as float) as confidence,\n    detection->>'bbox' as bbox\nfrom flattened", "relation_name": "\"medical_warehouse\".\"public\".\"stg_yolo_detections\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.160656Z", "completed_at": "2026-01-20T16:27:53.196527Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.196527Z", "completed_at": "2026-01-20T16:27:53.279668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11901187896728516, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "with raw_data as (\n    select * from \"medical_warehouse\".\"raw\".\"telegram_messages\"\n),\n\nflattened as (\n    select\n        message_id,\n        channel_name,\n        cast(date as timestamp) as message_date,\n        -- Extract fields from JSONB\n        cast(message_data->>'views' as integer) as view_count,\n        cast(message_data->>'forwards' as integer) as forward_count,\n        cast(message_data->>'message_text' as text) as message_text,\n        cast(message_data->>'has_media' as boolean) as has_media,\n        message_data->>'image_path' as image_path\n    from raw_data\n)\n\nselect\n    *,\n    LENGTH(message_text) as message_length\nfrom flattened\nwhere message_id is not null", "relation_name": "\"medical_warehouse\".\"public\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.286474Z", "completed_at": "2026-01-20T16:27:53.291601Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.291601Z", "completed_at": "2026-01-20T16:27:53.337984Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.05478334426879883, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.assert_no_future_messages", "compiled": true, "compiled_code": "select *\nfrom \"medical_warehouse\".\"public\".\"stg_telegram_messages\"\nwhere message_date > current_timestamp", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.343827Z", "completed_at": "2026-01-20T16:27:53.355971Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.356980Z", "completed_at": "2026-01-20T16:27:53.468403Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.12665963172912598, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "with staging as (\n    select * from \"medical_warehouse\".\"public\".\"stg_telegram_messages\"\n),\n\nchannel_stats as (\n    select\n        channel_name,\n        min(message_date) as first_post_date,\n        max(message_date) as last_post_date,\n        count(*) as total_posts,\n        avg(view_count) as avg_views\n    from staging\n    group by 1\n)\n\nselect\n    md5(cast(coalesce(cast(channel_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as channel_key,\n    channel_name,\n    case\n        when lower(channel_name) like '%pharma%' then 'Pharmaceutical'\n        when lower(channel_name) like '%cosmetic%' then 'Cosmetics'\n        when lower(channel_name) like '%clinic%' or lower(channel_name) like '%medical%' or lower(channel_name) like '%doctor%' then 'Medical'\n        else 'General Health'\n    end as channel_type,\n    first_post_date,\n    last_post_date,\n    total_posts,\n    round(avg_views, 2) as avg_views\nfrom channel_stats", "relation_name": "\"medical_warehouse\".\"public\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.343827Z", "completed_at": "2026-01-20T16:27:53.371297Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.371876Z", "completed_at": "2026-01-20T16:27:53.469476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12767553329467773, "adapter_response": {"_message": "SELECT 113", "code": "SELECT", "rows_affected": 113}, "message": "SELECT 113", "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "\n\nwith dates as (\n    select distinct cast(message_date as date) as full_date\n    from \"medical_warehouse\".\"public\".\"stg_telegram_messages\"\n)\n\nselect\n    md5(cast(coalesce(cast(full_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as date_key,\n    full_date,\n    extract(year from full_date) as year,\n    extract(month from full_date) as month,\n    to_char(full_date, 'Month') as month_name,\n    extract(day from full_date) as day,\n    extract(dow from full_date) as day_of_week,\n    extract(quarter from full_date) as quarter,\n    case\n        when extract(dow from full_date) in (0, 6) then true\n        else false\n    end as is_weekend\nfrom dates", "relation_name": "\"medical_warehouse\".\"public\".\"dim_dates\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.497572Z", "completed_at": "2026-01-20T16:27:53.507898Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.511753Z", "completed_at": "2026-01-20T16:27:53.551994Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07958507537841797, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.not_null_dim_dates_date_key.8dfe93e348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom \"medical_warehouse\".\"public\".\"dim_dates\"\nwhere date_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.490131Z", "completed_at": "2026-01-20T16:27:53.507172Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.509252Z", "completed_at": "2026-01-20T16:27:53.553610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08278250694274902, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_key as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"public\".\"dim_channels\"\nwhere channel_key is not null\ngroup by channel_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.480036Z", "completed_at": "2026-01-20T16:27:53.514819Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.514819Z", "completed_at": "2026-01-20T16:27:53.555214Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0838155746459961, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_key\nfrom \"medical_warehouse\".\"public\".\"dim_channels\"\nwhere channel_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.500775Z", "completed_at": "2026-01-20T16:27:53.514819Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.514819Z", "completed_at": "2026-01-20T16:27:53.565758Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08930063247680664, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.unique_dim_dates_date_key.61e1d0726d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_key as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"public\".\"dim_dates\"\nwhere date_key is not null\ngroup by date_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.572694Z", "completed_at": "2026-01-20T16:27:53.576348Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.576936Z", "completed_at": "2026-01-20T16:27:53.636950Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06534075736999512, "adapter_response": {"_message": "SELECT 476", "code": "SELECT", "rows_affected": 476}, "message": "SELECT 476", "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "\n\nwith staging as (\n    select * from \"medical_warehouse\".\"public\".\"stg_telegram_messages\"\n),\ndim_channels as (\n    select * from \"medical_warehouse\".\"public\".\"dim_channels\"\n),\ndim_dates as (\n    select * from \"medical_warehouse\".\"public\".\"dim_dates\"\n)\n\nselect\n    staging.message_id,\n    dim_channels.channel_key,\n    dim_dates.date_key,\n    staging.message_text,\n    staging.message_length,\n    staging.view_count,\n    staging.forward_count,\n    staging.has_media\nfrom staging\nleft join dim_channels on staging.channel_name = dim_channels.channel_name\nleft join dim_dates on cast(staging.message_date as date) = dim_dates.full_date", "relation_name": "\"medical_warehouse\".\"public\".\"fct_messages\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.648624Z", "completed_at": "2026-01-20T16:27:53.661417Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.662922Z", "completed_at": "2026-01-20T16:27:53.693789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05670285224914551, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_key as from_field\n    from \"medical_warehouse\".\"public\".\"fct_messages\"\n    where channel_key is not null\n),\n\nparent as (\n    select channel_key as to_field\n    from \"medical_warehouse\".\"public\".\"dim_channels\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.657640Z", "completed_at": "2026-01-20T16:27:53.665808Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.666810Z", "completed_at": "2026-01-20T16:27:53.697693Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05495595932006836, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.unique_fct_messages_message_id.655aa1a48d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    message_id as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"public\".\"fct_messages\"\nwhere message_id is not null\ngroup by message_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.652469Z", "completed_at": "2026-01-20T16:27:53.661417Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.664802Z", "completed_at": "2026-01-20T16:27:53.697693Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05954337120056152, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select date_key as from_field\n    from \"medical_warehouse\".\"public\".\"fct_messages\"\n    where date_key is not null\n),\n\nparent as (\n    select date_key as to_field\n    from \"medical_warehouse\".\"public\".\"dim_dates\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.645113Z", "completed_at": "2026-01-20T16:27:53.660401Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.661417Z", "completed_at": "2026-01-20T16:27:53.712343Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0708160400390625, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.medical_warehouse.not_null_fct_messages_message_id.de346706b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"medical_warehouse\".\"public\".\"fct_messages\"\nwhere message_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-20T16:27:53.717217Z", "completed_at": "2026-01-20T16:27:53.722282Z"}, {"name": "execute", "started_at": "2026-01-20T16:27:53.722282Z", "completed_at": "2026-01-20T16:27:53.786722Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07050633430480957, "adapter_response": {"_message": "SELECT 1031", "code": "SELECT", "rows_affected": 1031}, "message": "SELECT 1031", "failures": null, "unique_id": "model.medical_warehouse.fct_detections", "compiled": true, "compiled_code": "\n\nwith detections as (\n    select * from \"medical_warehouse\".\"public\".\"stg_yolo_detections\"\n),\nmessages as (\n    select * from \"medical_warehouse\".\"public\".\"fct_messages\"\n),\ndim_channels as (\n    select * from \"medical_warehouse\".\"public\".\"dim_channels\"\n),\ndim_dates as (\n    select * from \"medical_warehouse\".\"public\".\"dim_dates\"\n)\n\nselect\n    detections.message_id,\n    dim_channels.channel_key,\n    dim_dates.date_key,\n    detections.class_name,\n    detections.confidence\nfrom detections\nleft join messages on detections.message_id = messages.message_id\nleft join dim_channels on detections.channel_name = dim_channels.channel_name\nleft join dim_dates on messages.date_key = dim_dates.date_key", "relation_name": "\"medical_warehouse\".\"public\".\"fct_detections\"", "batch_results": null}], "elapsed_time": 0.8073301315307617, "args": {"warn_error_options": {"include": [], "exclude": []}, "select": [], "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "require_resource_names_without_spaces": false, "show_resource_report": false, "include_saved_query": false, "source_freshness_run_project_hooks": false, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "export_saved_queries": false, "strict_mode": false, "profiles_dir": "C:\\weak8milestone\\medical-telegram-warehouse", "quiet": false, "invocation_command": "dbt build", "macro_debugging": false, "require_yaml_configuration_for_mf_time_spines": false, "send_anonymous_usage_stats": true, "log_path": "C:\\weak8milestone\\medical-telegram-warehouse\\logs", "introspect": true, "vars": {}, "log_level": "info", "static_parser": true, "printer_width": 80, "use_colors_file": true, "which": "build", "populate_cache": true, "version_check": true, "log_format_file": "debug", "indirect_selection": "eager", "log_level_file": "debug", "show": false, "require_nested_cumulative_type_params": false, "project_dir": "C:\\weak8milestone\\medical-telegram-warehouse", "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "print": true, "cache_selected_only": false, "empty": false, "state_modified_compare_vars": false, "partial_parse": true, "write_json": true, "log_file_max_bytes": 10485760, "defer": false, "exclude_resource_types": [], "resource_types": [], "partial_parse_file_diff": true}}